# 《高性能sql》读书

## scheme与数据类型优化

1. 避免null，null时索引会需要一个额外的字节。
2. int(11)不会限制值的合法范围，对于存储和计算 int(1)和int(20)相同。
3. 范式与反范式，范式就是多表结合，反范式就是一个表梭哈，各有优劣。生产中基本上混用。
4.  缓存衍生值也是很好的策略，说人话就是临时表

## 创建高性能的索引

* 不考虑排序和分组时，将选择性高的列放到最前面是好的。
* 通过分析计算目标索引的实际数据量，如果数据量过大，索引跟全表扫描，区别不大
 ```
 SELECT COUNT(*),SUM(user_id =217 ),SUM(user_id =7738465 ) FROM activity_comm_receive_record ;
 ```
* 不要创建冗余索引，比如创建了索引（a,b），再创建索引（a）就是，因为这只是前一个索引的前缀索引。创建（b,a）则不是。
* 尽量维护索引，而不是新建索引
* 可以考虑分解关联查询，提高效率，比如拆分sql，使用IN关键字